<Window x:Class="Grafica.WordWindow"
     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
       xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls"
   WindowStartupLocation="CenterScreen"
       Title="WordWindow" Background="#1A1B24" WindowStyle="None" Height="788" Width="1287"
       ResizeMode="CanResize" AllowsTransparency="False"
          WindowState="Maximized"
        
        xmlns:fluent="urn:fluent-ribbon"
>


    <!---Referenciar los estilos de la pagina...-->
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Estilos/StylesMainWindow.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    <!--Window Chrome: ayuda a mover la pagina y crear barra superior...-->
    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="0" ResizeBorderThickness="6" GlassFrameThickness="0" UseAeroCaptionButtons="False"/>
    </WindowChrome.WindowChrome>


    <!--Grid1. Aqui se guarda la barra superior-->
    <Grid Background="{DynamicResource PrimaryDarkColor}">
        <!-- Definir estructura de filas -->
        <Grid.RowDefinitions>
            <!--Menu superior1 "menu strip y botones de ventana"-->
            <RowDefinition Height="40"/>
            <!--Menu superior2 "botones del programa"-->
            <RowDefinition Height="40"/>
            <!-- Alto del rctHeader -->
            <RowDefinition Height="*"/>
            <!-- Resto de la ventana -->
        </Grid.RowDefinitions>
        <!-- Header con botones de ventana -->


        <Grid Name="rctHeader"  Grid.Row="0" Height="40" VerticalAlignment="Top" Background="{DynamicResource IntermediateColor}"
              PreviewMouseLeftButtonDown="rctHeader_PreviewMouseLeftButtonDown"
              PreviewMouseLeftButtonUp="rctHeader_PreviewMouseLeftButtonUp"
              PreviewMouseMove="rctHeader_PreviewMouseMove">

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <!-- Icono -->
                <ColumnDefinition Width="Auto"/>
                <!-- Menú -->
                <ColumnDefinition Width="*"/>
                <!-- Espacio vacío -->
                <ColumnDefinition Width="Auto"/>
                <!-- Botones -->
            </Grid.ColumnDefinitions>

            <!-- Icono -->
            <Image Source="/Image/icono_libro.png" VerticalAlignment="Center" Margin="10,2,10,0" Grid.Column="0" Height="24" Width="24"/>

            <!-- Menú -->
            <Menu Name="MainMenu" Grid.Column="1" Background="Transparent" VerticalAlignment="Center"
                  PreviewMouseLeftButtonDown="Menu_PreviewMouseLeftButtonDown"
                  Margin="0,10,0,0">
                <Menu.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal" Background="Transparent"/>
                    </ItemsPanelTemplate>
                </Menu.ItemsPanel>
                <MenuItem Header="Archivo" Foreground="{DynamicResource SecundaryTextColor}" Click="MenuItem_Click">
                    <MenuItem Header="Nuevo">
                        <MenuItem Header="Asignatura" />
                        <MenuItem Header="Tema" />
                        <MenuItem Header="Archivo" />
                    </MenuItem>
                    <MenuItem Header="Abrir"/>
                    <MenuItem Header="Eliminar">
                        <MenuItem Header="Asignatura" />
                        <MenuItem Header="Tema"/>
                        <MenuItem Header="Archivo" />
                    </MenuItem>
                </MenuItem>
                <MenuItem Header="Editar" Foreground="{DynamicResource SecundaryTextColor}"/>
                <MenuItem Header="Ver" Foreground="{DynamicResource SecundaryTextColor}"/>

                <MenuItem Foreground="{DynamicResource SecundaryTextColor}" Margin="20,0,0,0">
                    <MenuItem.Header>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Image Source="/image/buscar.png" Width="14" Height="14" Margin="0,0,5,0"/>
                            <TextBlock Text="BuscarResumen" VerticalAlignment="Center"/>
                        </StackPanel>
                    </MenuItem.Header>
                </MenuItem>
            </Menu>

            <!-- Botones de ventana -->
            <StackPanel Grid.Column="3" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,0,0">
                <Button Width="50" Height="40" Margin="2,0" ToolTip="Minimizar" Click="Minimize_Click" Style="{StaticResource WindowButtonStyle}">
                    <Grid Width="10" Height="10" Margin="0, 3, 0, 0">
                        <Path Stroke="White" StrokeThickness="1" Stretch="Uniform"
                              Data="M 0,5 L 10,5"/>
                    </Grid>
                </Button>
                <Button x:Name="btnMaxRestore" Width="50" Height="40" Margin="2,0" ToolTip="Maximizar / Restaurar" Click="MaximizeRestore_Click" Style="{StaticResource WindowButtonStyle}">
                    <Grid x:Name="maxIcon" Width="20" Height="20" Margin="0, 3, 0, 0">
                        <Rectangle Stroke="White" StrokeThickness="1" Width="10" Height="10" />
                    </Grid>
                </Button>
                <Button Width="50" Height="40" Margin="2,0" ToolTip="Cerrar" Click="Close_Click" Style="{StaticResource CloseButtonStyle}">
                    <Grid Width="10" Height="10" Margin="0, 3, 0, 0">
                        <Path Stroke="White" StrokeThickness="1" Stretch="Uniform"
                              Data="M 0,0 L 10,10 M 10,0 L 0,10"/>
                    </Grid>
                </Button>
            </StackPanel>
            <Border Background="white" Height="1" VerticalAlignment="Bottom" Margin="0,0,0,0" BorderBrush="White" BorderThickness="0,0,0,0"/>

        </Grid>


        <!---Menu Superior segundo "Algunos botones del programa"-->
        <Grid Name="panelsuperior2" Grid.Row="1"  Background="{DynamicResource IntermediateColor}">

            <!-- Definir columnas -->
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Botones con sus respectivas imagenes -->
            <Image Source="/Image/barra2.png"
            Grid.Column="0"
            VerticalAlignment="Center"
            HorizontalAlignment="Left"
            Margin="15,0"
            Height="24" Width="20"/>
            <Button Name="Boton_Tema"
            Click="Boton_Tema_Click"
            Background="Transparent"
            BorderThickness="0"
            Cursor="Hand"
            Width="38" Height="40"
            ToolTip="Dark/Light"
            Focusable="False"
            Margin="40,0"
            HorizontalAlignment="Left"
            VerticalAlignment="Center">
                <Image x:Name="Tema_Icono"
            Source="/Image/boton_blanco_brillo.png"
            Width="24" Height="24"/>
            </Button>

            <Button Name="boton_exportar"
            Click="Boton_Exportar_Click"
            Background="#2B3544"
                    BorderThickness="0"
            Cursor="Hand"
            Width="40" Height="40"
            ToolTip="Exportar Asignatura"
            Focusable="False"
            Margin="80,0"
            HorizontalAlignment="Left"
            VerticalAlignment="Center">
                <Image x:Name="iconoexportar"
            Source="/image/exportar_Asignatura.png"
            Width="24" Height="24"/>
            </Button>

            <Button Name="boton_importar"
            Background="#2B3544"
            BorderThickness="0"
            Cursor="Hand"
            Width="40" Height="40"
            ToolTip="Importar Tema"
            Focusable="False"
            Margin="120,0"
            HorizontalAlignment="Left"
            VerticalAlignment="Center">
                <Image x:Name="iconoimportar"
            Source="/image/importar_tema.png"
            Width="24" Height="24"/>
            </Button>

            <Button Name="boton_importar_Archivo"
            Background="#2B3544"
            BorderThickness="0"
            Cursor="Hand"
            Width="40" Height="40"
            ToolTip="Importar Archivo"
            Focusable="False"
            Margin="160,0"
            HorizontalAlignment="Left"
            VerticalAlignment="Center">
                <Image x:Name="iconoimportarArchivo"
           Source="/image/importarArchivo.png"
           Width="24" Height="24"/>
            </Button>

            <Button Name="boton_expandirword"
            Background="#2B3544"
            BorderThickness="0"
            Cursor="Hand"
            Width="40" Height="40"
            ToolTip="Importar Archivo"
            Focusable="False"
            Margin="200,0"
            HorizontalAlignment="Left"
            VerticalAlignment="Center" Click="boton_expandirword_Click">
                <Image x:Name="expandir"
           Source="/image/expandir.png"
           Width="24" Height="24"/>
            </Button>


            <Button Name="boton_bloque"
            Background="#2B3544"
            BorderThickness="0"
            Cursor="Hand"
            Width="40" Height="40"
            ToolTip="Importar Archivo"
            Focusable="False"
            Margin="240,0"
            HorizontalAlignment="Left"
                    Click="Boton_NuevoBloque_Click"
            VerticalAlignment="Center" >
            
            </Button>


        </Grid>

        <!-- Panel que ocupa el resto de la ventana -->

        <Grid Name="Principal" Grid.Row="2" Background="{DynamicResource ColorFondo}">
            <Grid.ColumnDefinitions>
                <!-- Botones Principales "Resumenes, ..."-->
                <ColumnDefinition Width="*" />
                <!--Panel intermeido-->
                <ColumnDefinition Width="250" />
                <!-- Botones para el panel intermedio dinamico -->
                <ColumnDefinition Width="27" />
                <!-- panel derecho, "seleccion tema, asignatura, resumen, opciones..." -->
                <ColumnDefinition Width="250" />
            </Grid.ColumnDefinitions>

            <!-- GRID0: Botones princpales -->
            <StackPanel Grid.Column="0">
    

                <TextBlock 
                    Name="Titulo_Lista"
                    Text="RESUMEN"
                   FontSize="24"
                   FontWeight="Bold"
                   Foreground="{DynamicResource PrimaryTextColor}"
                   Margin="45,5,0,0"
                   HorizontalAlignment="Left">
                    <TextBlock.Effect>
                        <DropShadowEffect Color="Black" BlurRadius="3" ShadowDepth="0" Opacity="0.3"/>
                    </TextBlock.Effect>
                </TextBlock>
                <Border Height="2" Width="150"
                Background="{DynamicResource AccentColor}"
                HorizontalAlignment="Left"
                Margin="45,0,0,10"
                CornerRadius="1"/>


                <!-- Regla horizontal 
                <Canvas Height="30" Background="#EEE" Margin="40,0,40,0">-->
                <Canvas x:Name="RulerCanvas" Height="30" Background="#EEE" Margin="40,0,40,0">

                        <!-- Línea base -->
                    <!-- Marcas de centímetro/pulgada (ejemplo en px) -->
                    <TextBlock Text="0" Canvas.Left="0" Canvas.Top="5"/>
                    <TextBlock Text="1" Canvas.Left="50" Canvas.Top="5"/>
                    <TextBlock Text="2" Canvas.Left="100" Canvas.Top="5"/>
                    <TextBlock Text="3" Canvas.Left="150" Canvas.Top="5"/>
                    <TextBlock Text="4" Canvas.Left="200" Canvas.Top="5"/>
                    <TextBlock Text="5" Canvas.Left="250" Canvas.Top="5"/>
                    <TextBlock Text="6" Canvas.Left="300" Canvas.Top="5"/>
                    <TextBlock Text="7" Canvas.Left="350" Canvas.Top="5"/>
                    <TextBlock Text="8" Canvas.Left="400" Canvas.Top="5"/>
                    <TextBlock Text="9" Canvas.Left="450" Canvas.Top="5"/>
                    <TextBlock Text="10" Canvas.Left="500" Canvas.Top="5"/>
                    <TextBlock Text="11" Canvas.Left="550" Canvas.Top="5"/>
                    <TextBlock Text="12" Canvas.Left="600" Canvas.Top="5"/>
                    <TextBlock Text="13" Canvas.Left="650" Canvas.Top="5"/>
                    <TextBlock Text="14" Canvas.Left="700" Canvas.Top="5"/>
                    <TextBlock Text="15" Canvas.Left="750" Canvas.Top="5"/>
                    <TextBlock Text="16" Canvas.Left="800" Canvas.Top="5"/>
                    <TextBlock Text="17" Canvas.Left="850" Canvas.Top="5"/>
                    <TextBlock Text="18" Canvas.Left="900" Canvas.Top="5"/>

                    <Button x:Name="LeftMarginButton"
                Width="10" Height="20"
                Background="DodgerBlue"
                BorderBrush="Black"
                BorderThickness="1"
                Canvas.Top="5"
                Cursor="SizeWE"
                ToolTip="Arrastra para ajustar margen izquierdo"/>
                    <!-- Botón margen derecho -->
                    <Button x:Name="RightMarginButton"
                Width="10" Height="20"
                Background="Tomato"
                BorderBrush="Black"
                BorderThickness="1"
                Canvas.Top="5"
                Cursor="SizeWE"
                ToolTip="Arrastra para ajustar margen derecho"/>

                    <Button x:Name="FirstLineIndentButton"
        Width="10" Height="10"
        Background="Green"
        BorderBrush="Black"
        BorderThickness="1"
        Canvas.Top="0"  
                        Cursor="SizeWE"
        ToolTip="Arrastra para ajustar la sangría de primera línea"/>
                        <!-- Puedes seguir añadiendo más marcas -->
                </Canvas>

                <!-- Editor -->
                <RichTextBox 
                    Name="Editor"
                    Margin="40,10,40,20"
                    VerticalScrollBarVisibility="Visible"
                    AcceptsTab="True"
                    AcceptsReturn="True"
                    FontSize="14"
                    Height="650"
                    TextChanged="Editor_TextChanged"
                    PreviewTextInput="Editor_PreviewTextInput"
                    >

                    <FlowDocument 
                    FontSize="14"
                    LineStackingStrategy="BlockLineHeight" 
                    PagePadding="0">
                        
                        <Paragraph Margin="0"></Paragraph>

                    </FlowDocument>
                </RichTextBox>


            </StackPanel>

            <!-- Grid1: Panel Intermedio "panel dinamico, con los botones..." -->
            <ContentControl x:Name="PanelIntermedio"
                          Visibility="Collapsed"
             Style="{StaticResource IntermedioPanelStyle}"
             Grid.Column="1"
             Height="800"
             Width="240"
             Margin="0, 2, 5, 2"
             VerticalAlignment="Center"/>

            <!-- Grid2: Botones para el panel intermedio dinamico -->
            <StackPanel Grid.Column="2" 
            VerticalAlignment="Stretch"
            HorizontalAlignment="Stretch"
            Margin="0, 10, -3, 10"
            Background="Transparent">

                <!-- Botón 1 -->
                <Button Name="boton_menu1"
                        Click="boton_menu1_Click"
            Content="MENÚ 1"
            Style="{StaticResource VerticalMenuButtonStyle}"
            Height="270"
            Margin="0, 0, 0, 5"
            Cursor="Hand"/>

                <!-- Botón 2 -->
                <Button Name="boton_menu2"
                        Click="boton_menu2_Click"
            Content="MENÚ 2"
            Style="{StaticResource VerticalMenuButtonStyle}"
            Height="270"
            Margin="0, 0, 0, 5"
            Cursor="Hand"/>

                <!-- Botón 3 -->
                <Button Name="boton_menu3"
                        Click="boton_menu3_Click"
            Content="MENÚ 3"
            Style="{StaticResource VerticalMenuButtonStyle}"
            Height="270"
            Cursor="Hand"/>
            </StackPanel>




            <!-- grid3: panel derecho, "seleccion tema, asignatura, resumen, opciones..." -->
            <StackPanel Grid.Column="3"
                Background="{DynamicResource ColorPanelDerecho}"
                Margin="5,0,5,5"
                VerticalAlignment="Stretch">
                <StackPanel.Effect>
                    <DropShadowEffect Color="Black" BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                </StackPanel.Effect>
                <Border Height="2" Background="Green" HorizontalAlignment="Stretch" Margin="0,0,0,10"/>
                <TextBlock Text="ESQUEMA DE SELECCION"
                   Foreground="{DynamicResource SecundaryTextColor}"
                   FontWeight="SemiBold"
                   FontSize="16"
                   Margin="0,0,0,15"/>

                <TextBlock Text="Asignatura"
               TextAlignment="Center"
               Foreground="{DynamicResource SecundaryTextColor}"
               Margin="0,0,0,0"
               VerticalAlignment="Top"/>
                <ComboBox x:Name="AsignaturaCombobox" 
                        >

                </ComboBox>
                <Rectangle Height="1" Margin="0,10,0,0" Stroke="#2E3A34" StrokeThickness="1" StrokeDashArray="4 2"/>

                <!-- Reemplazo de Boton2 por ComboBox -->
                <TextBlock Text="Tema"
                TextAlignment="Center"
                Foreground="{DynamicResource SecundaryTextColor}"
                Margin="0,0,0,0"
                VerticalAlignment="Top"/>
                <ComboBox x:Name="ComboboxTemas" 
                ItemContainerStyle="{StaticResource CustomComboBoxItemStyle}"
>


                </ComboBox>

                <Separator Height="1" Margin="0,10,0,10" Background="#0F140F"/>


                <TextBlock Text="Archivo Selecccionado"
               TextAlignment="Center"
               Foreground="{DynamicResource SecundaryTextColor}"
               Margin="0,0,0,0"
               VerticalAlignment="Top"/>
                <TextBox Name="ArchivoSelect" Text="Resumen Seleccionado: 'NULL'" IsReadOnly="True" Background="white"/>

                <Separator Margin="0,200, 0, 5" Background="White" Height="1"/>

                <TextBlock Text="MENU DEL ARCHIVO"
                   TextAlignment="Center"
                   Foreground="{DynamicResource SecundaryTextColor}"
                   Margin="0,0,0,0"
                   VerticalAlignment="Top"/>

                <Border Height="1" Width="50" Background="White" HorizontalAlignment="Center" Margin="0,10,0,10"/>

                <UniformGrid Columns="2" HorizontalAlignment="Center" Margin="0,10,0,0">
                    <Button Content="Examen" Style="{StaticResource PanelDerechoButtonStyle}" Width="100" Height="30" Margin="5"/>
                    <Button Content="Practica" Style="{StaticResource PanelDerechoButtonStyle}" Width="100" Height="30" Margin="5"/>
                    <Button Content="Botón 3" Style="{StaticResource PanelDerechoButtonStyle}" Width="100" Height="30" Margin="5"/>
                    <Button Content="Botón 4" Style="{StaticResource PanelDerechoButtonStyle}" Width="100" Height="30" Margin="5"/>
                </UniformGrid>

                <Separator Height="1" Margin="0,10,0,10" Background="#0F140F"/>

            </StackPanel>
        </Grid>

        <!---Boton para cerrar La sesion del usuario...-->
        <Button x:Name="UserButton"
        Width="50"
        Height="50"
        VerticalAlignment="Bottom"
        HorizontalAlignment="Left"
        Margin="30,0,0,60"
        Style="{StaticResource StyledUserButton}" 
        Grid.Row="2" 
        Grid.Column="0"
        Cursor="Hand" 
        Click="UserButton_Click">
            <Image Source="/Image/cerrar_usuario.png"
           Width="28"
           Height="28"
           Stretch="Uniform"/>
        </Button>


    </Grid>
</Window>
